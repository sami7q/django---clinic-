{% extends 'base.html' %}
{% block content %}

<div class="p-8 space-y-10">

  <!-- ๐น ุงูุนููุงู + ุงูุฃุฒุฑุงุฑ -->
  <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
    <h1 class="text-2xl font-bold text-gray-800 tracking-tight">ุฅุฏุงุฑุฉ ุงูููุงุชูุฑ ูุงููููุงุช</h1>

    <div class="flex gap-3">
      <!-- ุฒุฑ ุฅูุดุงุก ูุงุชูุฑุฉ -->
      <a href="{% url 'invoices:create' %}" 
         class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition text-sm font-medium shadow-sm">
        + ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ
      </a>

      <!-- ุฒุฑ ุฅุถุงูุฉ ูููุงุช -->
      <a href="{% url 'invoices:expense_create' %}" 
         class="px-4 py-2 text-white rounded-lg text-sm font-medium shadow-sm transition"
         style="background-color:#f97316; border:1px solid #f97316;"
         onmouseover="this.style.backgroundColor='#ea580c'"
         onmouseout="this.style.backgroundColor='#f97316'">
        + ุฅุถุงูุฉ ูููุงุช
      </a>
    </div>
  </div>

  <!-- ๐งญ ุฃุฒุฑุงุฑ ุงูููุงุชุฑ -->
  <div class="flex flex-wrap gap-3">
    <a href="{% url 'invoices:filter' 'today' %}" 
       class="px-4 py-1.5 rounded-lg text-sm font-medium 
              {% if filter_label == 'ููุงุชูุฑ ุงูููู' %}bg-blue-600 text-white{% else %}bg-gray-100 text-gray-700 hover:bg-gray-200{% endif %}">
      ููุงุชูุฑ ุงูููู
    </a>
    <a href="{% url 'invoices:filter' 'yesterday' %}" 
       class="px-4 py-1.5 rounded-lg text-sm font-medium 
              {% if filter_label == 'ููุงุชูุฑ ุงูุฃูุณ' %}bg-blue-600 text-white{% else %}bg-gray-100 text-gray-700 hover:bg-gray-200{% endif %}">
      ููุงุชูุฑ ุงูุฃูุณ
    </a>
    <a href="{% url 'invoices:filter' 'all' %}" 
       class="px-4 py-1.5 rounded-lg text-sm font-medium 
              {% if filter_label == 'ุฌููุน ุงูููุงุชูุฑ' %}bg-blue-600 text-white{% else %}bg-gray-100 text-gray-700 hover:bg-gray-200{% endif %}">
      ุฌููุน ุงูููุงุชูุฑ
    </a>

    <a href="{% url 'invoices:expense_list' %}" 
       class="px-4 py-1.5 rounded-lg text-sm font-medium 
              {% if 'ูููุงุช' in filter_label %}bg-orange-500 text-white{% else %}bg-gray-100 text-gray-700 hover:bg-gray-200{% endif %}">
      ุงููููุงุช
    </a>
  </div>

  <!-- ๐ฐ ุงูุฅุญุตุงุฆูุงุช -->
  <div class="grid grid-cols-1 sm:grid-cols-3 gap-5">
    <div class="bg-white border border-gray-200 rounded-xl p-4 shadow-sm">
      <p class="text-sm text-gray-500">ุฅุฌูุงูู ุงูุฏุฎู</p>
      <p class="text-2xl font-bold text-green-600 mt-1">{{ total_revenue|default:"0" }} ุฏ.ุน</p>
    </div>

    <div class="bg-white border border-gray-200 rounded-xl p-4 shadow-sm">
      <p class="text-sm text-gray-500">ุฅุฌูุงูู ุงููููุงุช</p>
      <p class="text-2xl font-bold text-orange-500 mt-1">{{ total_expenses|default:"0" }} ุฏ.ุน</p>
    </div>

    <div class="bg-white border border-gray-200 rounded-xl p-4 shadow-sm">
      <p class="text-sm text-gray-500">ุนุฏุฏ ุงูููุงุชูุฑ</p>
      <p class="text-2xl font-bold text-blue-600 mt-1">{{ invoice_count }}</p>
    </div>
  </div>

  <!-- ๐งพ ุฌุฏูู ุงูููุงุชูุฑ -->
  <div class="bg-white border border-gray-200 rounded-2xl shadow-sm overflow-hidden">
    <table class="min-w-full text-sm text-left">
      <thead class="bg-gray-100 text-gray-700 text-xs uppercase">
        <tr>
          <th class="px-6 py-3">ุฑูู</th>
          <th class="px-6 py-3">ุงููุฑูุถ</th>
          <th class="px-6 py-3">ุงููุจูุบ</th>
          <th class="px-6 py-3">ุงูุญุงูุฉ</th>
          <th class="px-6 py-3">ุงูุชุงุฑูุฎ</th>
          <th class="px-6 py-3 text-right">ุงูุฅุฌุฑุงุกุงุช</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-100">
        {% for invoice in invoices %}
        <tr class="hover:bg-gray-50 transition">
          <td class="px-6 py-3 text-gray-600 font-medium">#{{ invoice.invoice_number }}</td>
          <td class="px-6 py-3 text-gray-800 font-medium">{{ invoice.patient.name }}</td>
          <td class="px-6 py-3 font-semibold text-green-700">{{ invoice.paid_amount|floatformat:0 }} ุฏ.ุน</td>
          <td class="px-6 py-3">
            {% if invoice.status == "ูุฏููุนุฉ" %}
              <span class="px-3 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full">ูุฏููุนุฉ</span>
            {% elif invoice.status == "ูุคุฌูุฉ" %}
              <span class="px-3 py-1 bg-yellow-100 text-yellow-700 text-xs font-medium rounded-full">ูุคุฌูุฉ</span>
            {% else %}
              <span class="px-3 py-1 bg-red-100 text-red-600 text-xs font-medium rounded-full">ุบูุฑ ูุฏููุนุฉ</span>
            {% endif %}
          </td>
          <td class="px-6 py-3 text-gray-600">{{ invoice.date|date:"Y-m-d - h:i A" }}</td>
          <td class="px-6 py-3 text-right space-x-2 rtl:space-x-reverse">
            <a href="{% url 'invoices:update' invoice.id %}" 
               class="inline-block px-3 py-1.5 text-sm bg-blue-50 text-blue-700 rounded-md border border-blue-200 hover:bg-blue-100 transition">
              ุชุนุฏูู
            </a>
            <a href="{% url 'invoices:delete' invoice.id %}" 
               class="inline-block px-3 py-1.5 text-sm bg-red-50 text-red-700 rounded-md border border-red-200 hover:bg-red-100 transition">
              ุญุฐู
            </a>
            <a href="{% url 'invoices:print' invoice.id %}" 
               class="inline-block px-3 py-1.5 text-sm bg-gray-50 text-gray-700 rounded-md border border-gray-200 hover:bg-gray-100 transition">
              ุทุจุงุนุฉ
            </a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="text-center py-6 text-gray-500">ูุง ุชูุฌุฏ ููุงุชูุฑ ุญุงููุงู</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>

{% endblock %}

{% extends 'base.html' %}
{% block content %}

<div class="p-8 space-y-10">

  <!-- ğŸ”¹ Ø§Ù„ØªØ­ÙŠØ© -->
  <header class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
    <div>
      <h1 class="text-2xl font-bold text-gray-800">
        Ù…Ø±Ø­Ø¨Ø§Ù‹ {{ request.user.first_name|default:request.user.username }}
      </h1>
      <p class="text-gray-500 text-sm">Ù†ØªÙ…Ù†Ù‰ Ù„Ùƒ ÙŠÙˆÙ…Ø§Ù‹ Ù…ÙˆÙÙ‚Ø§Ù‹ ÙÙŠ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©</p>
    </div>

    <a href="{% url 'appointments:create' %}"
       class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium shadow-sm">
      + Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¹Ø¯ Ø¬Ø¯ÙŠØ¯
    </a>
  </header>

  <!-- ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5">
    <div class="bg-white border border-gray-200 rounded-xl p-5 shadow-sm hover:shadow-md transition">
      <p class="text-gray-500 text-sm mb-1">Ø§Ù„Ù…Ø±Ø¶Ù‰</p>
      <h2 class="text-3xl font-bold text-blue-700">{{ total_patients }}</h2>
      <p class="text-xs text-gray-500 mt-1">+{{ today_patients }} Ø§Ù„ÙŠÙˆÙ…</p>
    </div>

    <div class="bg-white border border-gray-200 rounded-xl p-5 shadow-sm hover:shadow-md transition">
      <p class="text-gray-500 text-sm mb-1">Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯</p>
      <h2 class="text-3xl font-bold text-emerald-700">{{ total_appointments }}</h2>
      <p class="text-xs text-gray-500 mt-1">+{{ recent_appointments }} Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©</p>
    </div>

    <div class="bg-white border border-gray-200 rounded-xl p-5 shadow-sm hover:shadow-md transition">
      <p class="text-gray-500 text-sm mb-1">Ø§Ù„ÙÙˆØ§ØªÙŠØ±</p>
      <h2 class="text-3xl font-bold text-green-700">{{ total_invoices|floatformat:0 }} Ø¯.Ø¹</h2>
      <p class="text-xs text-gray-500 mt-1">+{{ this_week_invoices|floatformat:0 }} Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</p>
    </div>

    <div class="bg-white border border-gray-200 rounded-xl p-5 shadow-sm hover:shadow-md transition">
      <p class="text-gray-500 text-sm mb-1">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†</p>
      <h2 class="text-3xl font-bold text-indigo-700">{{ users_count }}</h2>
      <p class="text-xs text-gray-500 mt-1">Ù†Ø´Ø·ÙˆÙ† Ø­Ø§Ù„ÙŠØ§Ù‹</p>
    </div>
  </div>

  <!-- âš¡ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø© -->
  <section>
    <h2 class="text-lg font-semibold text-gray-800 mb-4">Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø©</h2>
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
      <a href="{% url 'patients:create' %}" class="shortcut-btn bg-blue-50 border-blue-100 text-blue-700">Ù…Ø±ÙŠØ¶ Ø¬Ø¯ÙŠØ¯</a>
      <a href="{% url 'appointments:create' %}" class="shortcut-btn bg-green-50 border-green-100 text-green-700">Ù…ÙˆØ¹Ø¯ Ø¬Ø¯ÙŠØ¯</a>
      <a href="{% url 'invoices:create' %}" class="shortcut-btn bg-indigo-50 border-indigo-100 text-indigo-700">ÙØ§ØªÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©</a>
      <a href="{% url 'invoices:expense_create' %}" class="shortcut-btn bg-orange-50 border-orange-100 text-orange-700">Ø¥Ø¶Ø§ÙØ© Ù†ÙÙ‚Ø§Øª</a>
      <a href="{% url 'patients:list' %}" class="shortcut-btn bg-gray-50 border-gray-100 text-gray-700">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±Ø¶Ù‰</a>
      <a href="{% url 'users:list' %}" class="shortcut-btn bg-cyan-50 border-cyan-100 text-cyan-700">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†</a>
    </div>
  </section>

  <!-- ğŸ§¾ Ø¢Ø®Ø± Ø§Ù„Ø£Ù†Ø´Ø·Ø© -->
  <section>
    <h2 class="text-lg font-semibold text-gray-800 mb-3">Ø¢Ø®Ø± Ø§Ù„Ø£Ù†Ø´Ø·Ø©</h2>
    <div class="space-y-2">
      {% for activity in recent_activities %}
        <div class="flex justify-between items-center bg-white border border-gray-200 rounded-xl px-4 py-2.5 shadow-sm hover:bg-gray-50 transition">
          <p class="text-sm text-gray-700">{{ activity.text }}</p>
          <p class="text-xs text-gray-500">{{ activity.date|date:"d/m/Y" }}</p>
        </div>
      {% empty %}
        <p class="text-gray-500 text-center bg-gray-50 py-3 rounded-xl border border-gray-100">
          Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù†Ø´Ø·Ø© Ø­Ø¯ÙŠØ«Ø©
        </p>
      {% endfor %}
    </div>
  </section>

  <!-- â° Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© -->
  <section>
    <h2 class="text-lg font-semibold text-gray-800 mb-3">Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</h2>
    <div class="bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden">
      <table class="min-w-full text-sm text-gray-700">
        <thead class="bg-gray-100 text-gray-600 uppercase text-xs">
          <tr>
            <th class="px-6 py-3">Ø§Ù„Ù…Ø±ÙŠØ¶</th>
            <th class="px-6 py-3">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
            <th class="px-6 py-3">Ø§Ù„ÙˆÙ‚Øª</th>
            <th class="px-6 py-3 text-right">Ø§Ù„Ø­Ø§Ù„Ø©</th>
          </tr>
        </thead>
        <tbody>
          {% if upcoming_appointments %}
            {% for a in upcoming_appointments %}
              <tr class="border-t hover:bg-gray-50 transition">
                <td class="px-6 py-3">{{ a.patient.name }}</td>
                <td class="px-6 py-3">{{ a.date|date:"Y-m-d" }}</td>
                <td class="px-6 py-3">{{ a.time|time:"H:i" }}</td>
                <td class="px-6 py-3 text-right">
                  <span class="px-3 py-1 rounded-full text-xs font-medium 
                    {% if a.status == 'ØªÙ…Øª Ø§Ù„Ø²ÙŠØ§Ø±Ø©' %}bg-green-100 text-green-700
                    {% elif a.status == 'Ø£Ù„ØºÙŠØª' %}bg-red-100 text-red-700
                    {% else %}bg-blue-100 text-blue-700{% endif %}">
                    {{ a.status }}
                  </span>
                </td>
              </tr>
            {% endfor %}
          {% else %}
            <tr>
              <td colspan="4" class="text-center py-6 text-gray-500">
                Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø¹ÙŠØ¯ Ù‚Ø§Ø¯Ù…Ø©
              </td>
            </tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  </section>

</div>

<style>
.shortcut-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0.9rem 0.5rem;
  border-radius: 0.75rem;
  font-weight: 500;
  font-size: 0.875rem;
  border: 1px solid;
  transition: all 0.2s;
  box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}
.shortcut-btn:hover {
  transform: translateY(-1px);
  background-color: rgba(59,130,246,0.05);
}
</style>

{% endblock %}
